{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/mocha-js-delegate/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/execute-javascript.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/inject-client-messaging.js","webpack://exports/./node_modules/sketch-module-web-view/lib/movable-area.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./resources/export/index.js","webpack://exports/./resources/store/artboard.js","webpack://exports/./resources/store/images.js","webpack://exports/./resources/store/index.js","webpack://exports/./resources/store/svgs.js","webpack://exports/./resources/ui/index.html","webpack://exports/./resources/ui/spec.html","webpack://exports/./resources/ui/style.css","webpack://exports/./src/export.js","webpack://exports/external \"events\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/ui\""],"names":["getRoot","context","scriptPath","stringByDeletingLastPathComponent","getFileContent","filePath","NSString","stringWithContentsOfFile_encoding_error","nil","getSavePath","document","fileURL","path","fileName","displayName","stringByDeletingPathExtension","savePanel","NSSavePanel","setTitle","setNameFieldLabel","setPrompt","setCanCreateDirectories","setNameFieldStringValue","runModal","NSOKButton","URL","writeFile","options","content","stringWithString","savePathName","NSFileManager","defaultManager","createDirectoryAtPath_withIntermediateDirectories_attributes_error","push","join","writeToFile_atomically_encoding_error","removeIrrelevantLayers","layers","length","forEach","layer","type","remove","detatchSymbols","detach","recursively","removeHiddenLayers","hidden","transparent","style","opacity","hiddenOrTransparent","maskGroupToImageLayer","maskGroup","sketch","buffer","formats","output","imageLayer","Image","name","image","frame","masksToImages","hasClippingMask","sketchObject","hasParentGroup","parent","parentIndex","index","parentsParent","splice","flattenGroups","ungroup","roundFrameDimensions","x","Math","round","y","width","height","getArtboard","selectedArtboard","artboard","duplicate","createBase64Image","nsdata","id","newImageBase64","base64EncodedStringWithOptions","newImage","src","base64ImageBatch","images","map","layerToBase64","bufferImg","gradientToBase64","activeGradients","fills","filter","fill","enabled","fillType","topGradient","borders","shadows","innerShadows","transform","rotation","flippedHorizontally","flippedVertically","points","point","cornerRadius","getBase64Gradients","hasActiveGradient","some","layerDuplicate","base64Gradient","getLayerImages","getFillImages","pattern","getImages","layerImages","fillImages","base64LayerImages","base64FillImages","base64Gradients","getStore","svgs","getSVGs","notes","getOddShapePathSVGs","hasOpenPath","closed","notRectangle","shapeType","notOval","isOddShape","NSTemporaryDirectory","svgContent","svg","getShapeSVGs","shapeSvgs","oddShapePathSvgs","webviewIdentifier","getSelectedDocument","selectedLayers","find","selected","store","browserWindow","BrowserWindow","identifier","fullscreenable","show","maximize","center","webContents","loadURL","require","on","executeJavaScript","JSON","stringify","parse","data","savePath","pluginExport","pluginRoot","scriptSourceMapPath","stylesPath","replace","templatePath","styleName","substr","template","styles","script","scriptWithStore","scriptSourceMap","ui","alert","onShutdown","existingWebview","getWebview","close"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC9QA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,wDAAwD,EAAE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,uCAAuC;AACvC;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,+BAA+B;AACnE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,+BAA+B;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAoC,aAAa;AACjD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACRA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,yCAAyC;AACzC,uDAAuD;AACvD,6DAA6D;AAC7D,+BAA+B;AAC/B,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR,gBAAgB;AAChB,MAAM,eAAe;AACrB,0CAA0C,cAAc;AACxD,MAAM;AACN;AACA;;;;;;;;;;;;ACzBA,+DAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,YAAY;AACZ,gCAAgC;AAChC,wFAAwF;AACxF,qCAAqC;AACrC;AACA;AACA,mBAAmB;AACnB,YAAY;AACZ,kCAAkC;AAClC;AACA;AACA,kBAAkB;AAClB,YAAY;AACZ,UAAU,OAAO;AACjB;AACA;AACA,kBAAkB;AAClB,UAAU;AACV,QAAQ,cAAc;AACtB;AACA;AACA,kBAAkB;AAClB,QAAQ;AACR,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,sBAAsB,mBAAO,CAAC,+EAAe;AAC7C,kBAAkB,mBAAO,CAAC,+EAAe;AACzC,uBAAuB,mBAAO,CAAC,6EAAc;AAC7C,yBAAyB,mBAAO,CAAC,iGAAwB;AACzD,4BAA4B,mBAAO,CAAC,uGAA2B;AAC/D,kBAAkB,mBAAO,CAAC,iFAAgB;AAC1C,wBAAwB,mBAAO,CAAC,6FAAsB;AACtD,mBAAmB,mBAAO,CAAC,mFAAiB;;AAE5C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;ACxWA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,qDAAqD;AACrD,gDAAgD;AAChD,yBAAyB;AACzB;AACA,QAAQ;AACR,uDAAuD;AACvD,6CAA6C;AAC7C,0BAA0B;AAC1B,sDAAsD;AACtD;AACA;AACA,uBAAuB;AACvB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,wCAAwC;AACxC,QAAQ,EAAE;AACV,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjCA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,mBAAmB;AACnB,yDAAyD;AACzD;AACA,kCAAkC;AAClC,2CAA2C,4BAA4B,eAAe;AACtF,gCAAgC,yBAAyB,cAAc;AACvE;AACA,OAAO;AACP;AACA,8BAA8B;AAC9B,qDAAqD,SAAS;AAC9D;AACA;AACA,QAAQ;AACR,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;AC/DA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClBA,+DAAgB,mBAAO,CAAC,oEAAmB;AAC3C,wBAAwB,mBAAO,CAAC,2FAAqB;AACrD,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,2CAA2C;AAC3C,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;;AAEV;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;;AAEH;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,sBAAsB;;AAE7C;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,OAAO;AACP;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;AChZA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,wBAAwB,mBAAO,CAAC,6FAAsB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA,QAAQ,kCAAkC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACrOA;AACA;;AAEA;AACA,SAAS,mBAAO,CAAC,iEAAO;AACxB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;AClCA;AAAA;AAAA;AAAA;AAAA;AAAO,IAAMA,OAAO,GAAG,SAAVA,OAAU,CAACC,OAAD,EAAa;AAChC,SAAOA,OAAO,CAACC,UAAR,CAAmBC,iCAAnB,GAAuDA,iCAAvD,GAA2FA,iCAA3F,EAAP;AACH,CAFM;AAGA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,QAAD,EAAc;AACxC;AACA,SAAOC,QAAQ,CAACC,uCAAT,CAAiDF,QAAjD,EAA2D,CAA3D,EAA8DG,GAA9D,CAAP;AACH,CAHM;AAIA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACR,OAAD,EAAa;AACpC,MAAII,QAAQ,GAAGJ,OAAO,CAACS,QAAR,CAAiBC,OAAjB,KAA6BV,OAAO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","file":"__export.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/export.js\");\n","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","/* globals MOClassDescription, NSObject, NSSelectorFromString, NSClassFromString, MOPropertyDescription */\n\nmodule.exports = function MochaDelegate(definition, superclass) {\n  var uniqueClassName =\n    'MochaJSDelegate_DynamicClass_' + NSUUID.UUID().UUIDString()\n\n  var delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(\n    uniqueClassName,\n    superclass || NSObject\n  )\n\n  // Storage\n  var handlers = {}\n  var ivars = {}\n\n  // Define an instance method\n  function setHandlerForSelector(selectorString, func) {\n    var handlerHasBeenSet = selectorString in handlers\n    var selector = NSSelectorFromString(selectorString)\n\n    handlers[selectorString] = func\n\n    /*\n      For some reason, Mocha acts weird about arguments: https://github.com/logancollins/Mocha/issues/28\n      We have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n    */\n    if (!handlerHasBeenSet) {\n      var args = []\n      var regex = /:/g\n      while (regex.exec(selectorString)) {\n        args.push('arg' + args.length)\n      }\n\n      // eslint-disable-next-line no-eval\n      var dynamicFunction = eval(\n        '(function (' +\n          args.join(', ') +\n          ') { return handlers[selectorString].apply(this, arguments); })'\n      )\n\n      delegateClassDesc.addInstanceMethodWithSelector_function(\n        selector,\n        dynamicFunction\n      )\n    }\n  }\n\n  // define a property\n  function setIvar(key, value) {\n    var ivarHasBeenSet = key in handlers\n\n    ivars[key] = value\n\n    if (!ivarHasBeenSet) {\n      delegateClassDesc.addInstanceVariableWithName_typeEncoding(key, '@')\n      var description = MOPropertyDescription.new()\n      description.name = key\n      description.typeEncoding = '@'\n      description.weak = true\n      description.ivarName = key\n      delegateClassDesc.addProperty(description)\n    }\n  }\n\n  this.getClass = function() {\n    return NSClassFromString(uniqueClassName)\n  }\n\n  this.getClassInstance = function(instanceVariables) {\n    var instance = NSClassFromString(uniqueClassName).new()\n    Object.keys(ivars).forEach(function(key) {\n      instance[key] = ivars[key]\n    })\n    Object.keys(instanceVariables || {}).forEach(function(key) {\n      instance[key] = instanceVariables[key]\n    })\n    return instance\n  }\n  // alias\n  this.new = this.getClassInstance\n\n  // Convenience\n  if (typeof definition === 'object') {\n    Object.keys(definition).forEach(\n      function(key) {\n        if (typeof definition[key] === 'function') {\n          setHandlerForSelector(key, definition[key])\n        } else {\n          setIvar(key, definition[key])\n        }\n      }\n    )\n  }\n\n  delegateClassDesc.registerClass()\n}\n","function parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      typeof color.isKindOfClass === 'function' &&\n      color.isKindOfClass(NSColor)\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16)\n  var g = parseInt(hex.slice(2, 4), 16)\n  var b = parseInt(hex.slice(4, 6), 16)\n  var a = parseInt(hex.slice(6, 8), 16)\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function(browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function() {\n    return panel.close()\n  }\n\n  browserWindow.close = function() {\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      var shouldClose = true\n      browserWindow.emit('close', {\n        get defaultPrevented() {\n          return !shouldClose\n        },\n        preventDefault: function() {\n          shouldClose = false\n        },\n      })\n      if (shouldClose) {\n        panel.delegate().utils.parentWindow.endSheet(panel)\n      }\n      return\n    }\n\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (!browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n      NSApp.mainWindow().makeKeyAndOrderFront(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function() {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function() {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function() {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      return panel.delegate().utils.parentWindow.beginSheet_completionHandler(\n        panel,\n        __mocha__.createBlock_function('v16@?0q8', function() {\n          browserWindow.emit('closed')\n        })\n      )\n    }\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function() {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function() {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function() {\n    return false\n  }\n\n  browserWindow.maximize = function() {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function() {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function() {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function() {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function() {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function() {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function(fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function() {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function(aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function(bounds, animate) {\n    if (!bounds) {\n      return\n    }\n\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    const newBounds = Object.assign(browserWindow.getBounds(), bounds)\n\n    // TODO: Check size constraints since setFrame does not check it.\n    // var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(\n      newBounds.x,\n      0,\n      newBounds.width,\n      newBounds.height\n    )\n    // Flip Y coordinates based on the primary screen\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y = NSHeight(screen.frame()) - newBounds.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function() {\n    const cocoaBounds = panel.frame()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    return {\n      x: cocoaBounds.origin.x,\n      y: Math.round(NSHeight(mainScreenRect) - cocoaBounds.origin.y),\n      width: cocoaBounds.size.width,\n      height: cocoaBounds.size.height,\n    }\n  }\n\n  browserWindow.setContentBounds = function(bounds, animate) {\n    // TODO:\n    browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getContentBounds = function() {\n    // TODO:\n    return browserWindow.getBounds()\n  }\n\n  browserWindow.setSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setBounds({ width: width, height: height }, animate)\n  }\n\n  browserWindow.getSize = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setContentSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setContentBounds(\n      { width: width, height: height },\n      animate\n    )\n  }\n\n  browserWindow.getContentSize = function() {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setMinimumSize = function(width, height) {\n    const minSize = CGSizeMake(width, height)\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function() {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function(width, height) {\n    const maxSize = CGSizeMake(width, height)\n    panel.setContentMaxSize(maxSize)\n  }\n\n  browserWindow.getMaximumSize = function() {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function(resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function() {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function(movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function() {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function(minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function() {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function(maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function() {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function(fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function(closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function() {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function(top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function() {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function() {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function(x, y, animate) {\n    return browserWindow.setBounds({ x: x, y: y }, animate)\n  }\n\n  browserWindow.getPosition = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.x, bounds.y]\n  }\n\n  browserWindow.setTitle = function(title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function() {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function(flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function() {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function() {\n    return webview\n  }\n\n  browserWindow.loadURL = function(url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!https?|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url =\n          'file://' +\n          __command\n            .pluginBundle()\n            .urlForResourceNamed(url)\n            .path()\n      }\n    }\n\n    if (/^file:\\/\\/.*\\.html?$/.test(url)) {\n      // ensure URLs containing spaces are properly handled\n      url = NSString.alloc().initWithString(url)\n      url = url.stringByAddingPercentEncodingWithAllowedCharacters(\n        NSCharacterSet.URLQueryAllowedCharacterSet()\n      )\n      webview.loadFileURL_allowingReadAccessToURL(\n        NSURL.URLWithString(url),\n        NSURL.URLWithString('file:///')\n      )\n      return\n    }\n\n    const properURL = NSURL.URLWithString(url)\n    const urlRequest = NSURLRequest.requestWithURL(properURL)\n\n    webview.loadRequest(urlRequest)\n  }\n\n  browserWindow.reload = function() {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function(hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function() {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function(opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function() {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function(visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function(ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function(enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function(autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function(type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function(colorName) {\n    var color = parseHexColor(colorName)\n    webview.setValue_forKey(false, 'drawsBackground')\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function() {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function(button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n  JS_BRIDGE_RESULT_SUCCESS: '__skpm_sketchBridge_success',\n  JS_BRIDGE_RESULT_ERROR: '__skpm_sketchBridge_error',\n  START_MOVING_WINDOW: '__skpm_startMovingWindow',\n  EXECUTE_JAVASCRIPT: '__skpm_executeJS',\n  EXECUTE_JAVASCRIPT_SUCCESS: '__skpm_executeJS_success_',\n  EXECUTE_JAVASCRIPT_ERROR: '__skpm_executeJS_error_',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function(webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    point.x +\n    ', ' +\n    point.y +\n    '); ' +\n    'if (el && el.tagName === \"SELECT\") {' + // select needs special handling\n    '  var event = document.createEvent(\"MouseEvents\");' +\n    '  event.initMouseEvent(\"mousedown\", true, true, window);' +\n    '  el.dispatchEvent(event);' +\n    '} else if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webview, browserWindow) {\n  function executeJavaScript(script, userGesture, callback) {\n    if (typeof userGesture === 'function') {\n      callback = userGesture\n      userGesture = false\n    }\n    var fiber = coscript.createFiber()\n\n    // if the webview is not ready yet, defer the execution until it is\n    if (\n      webview.navigationDelegate().state &&\n      webview.navigationDelegate().state.wasReady == 0\n    ) {\n      return new Promise(function(resolve, reject) {\n        browserWindow.once('ready-to-show', function() {\n          executeJavaScript(script, userGesture, callback)\n            .then(resolve)\n            .catch(reject)\n          fiber.cleanup()\n        })\n      })\n    }\n\n    return new Promise(function(resolve, reject) {\n      var requestId = Math.random()\n\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS + requestId,\n        function(res) {\n          try {\n            if (callback) {\n              callback(null, res)\n            }\n            resolve(res)\n          } catch (err) {\n            reject(err)\n          }\n          fiber.cleanup()\n        }\n      )\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_ERROR + requestId,\n        function(err) {\n          try {\n            if (callback) {\n              callback(err)\n              resolve()\n            } else {\n              reject(err)\n            }\n          } catch (err2) {\n            reject(err2)\n          }\n          fiber.cleanup()\n        }\n      )\n\n      webview.evaluateJavaScript_completionHandler(\n        module.exports.wrapScript(script, requestId),\n        null\n      )\n    })\n  }\n\n  return executeJavaScript\n}\n\nmodule.exports.wrapScript = function(script, requestId) {\n  return (\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    '(' +\n    requestId +\n    ', ' +\n    JSON.stringify(script) +\n    ')'\n  )\n}\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    ' = function(id, script) {' +\n    '  try {' +\n    '    var res = eval(script);' +\n    '    if (res && typeof res.then === \"function\" && typeof res.catch === \"function\") {' +\n    '      res.then(function (res2) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res2);' +\n    '      })' +\n    '      .catch(function (err) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '      })' +\n    '    } else {' +\n    '      window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res);' +\n    '    }' +\n    '  } catch (err) {' +\n    '    window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '  }' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar injectClientMessaging = require('./inject-client-messaging')\nvar movableArea = require('./movable-area')\nvar executeJavaScript = require('./execute-javascript')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || NSUUID.UUID().UUIDString()\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (options.modal && !options.parent) {\n    throw new Error('A modal needs to have a parent.')\n  }\n\n  // Long-running script\n  var fiber = coscript.createFiber()\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens()\n    .firstObject()\n    .frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? NSHeight(mainScreenRect) - options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  var wkwebviewConfig = WKWebViewConfiguration.alloc().init()\n  var webView = WKWebView.alloc().initWithFrame_configuration(\n    CGRectMake(0, 0, options.width || 800, options.height || 600),\n    wkwebviewConfig\n  )\n  injectClientMessaging(webView)\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView, options)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  let title = options.title\n  if (options.frame === false) {\n    title = undefined\n  } else if (\n    typeof title === 'undefined' &&\n    typeof __command !== 'undefined' &&\n    __command.pluginBundle()\n  ) {\n    title = __command.pluginBundle().name()\n  }\n\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  options.webPreferences = options.webPreferences || {}\n\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.devTools !== false,\n      'developerExtrasEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.javascript !== false,\n      'javaScriptEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(!!options.webPreferences.plugins, 'plugInsEnabled')\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.minimumFontSize || 0,\n      'minimumFontSize'\n    )\n\n  if (options.webPreferences.zoomFactor) {\n    webView.setMagnification(options.webPreferences.zoomFactor)\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  panel.setHidesOnDeactivate(options.hidesOnDeactivate !== false)\n\n  if (options.remembersWindowFrame) {\n    panel.setFrameAutosaveName(identifier)\n    panel.setFrameUsingName_force(panel.frameAutosaveName(), false)\n  }\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function(event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents\n          .executeJavaScript(dispatchFirstClick(webView, event))\n          .catch(() => {})\n      }\n    })\n  }\n\n  executeJavaScript.injectScript(webView)\n  movableArea.injectScript(webView)\n  movableArea.setupHandler(browserWindow)\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function() {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    var observer = threadDictionary[identifier + '.themeObserver']\n    if (observer) {\n      NSApplication.sharedApplication().removeObserver_forKeyPath(\n        observer,\n        'effectiveAppearance'\n      )\n      threadDictionary.removeObjectForKey(identifier + '.themeObserver')\n    }\n    fiber.cleanup()\n  })\n\n  threadDictionary[identifier] = panel\n\n  fiber.onCleanup(function() {\n    if (!browserWindow._destroyed) {\n      browserWindow.destroy()\n    }\n  })\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function(identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function(panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webView &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webView = subviews[i]\n    }\n  }\n\n  if (!webView) {\n    throw new Error('The panel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webView) {\n  var source =\n    'window.originalPostMessage = window.postMessage;' +\n    'window.postMessage = function(actionName) {' +\n    '  if (!actionName) {' +\n    \"    throw new Error('missing action name')\" +\n    '  }' +\n    '  var id = String(Math.random()).replace(\".\", \"\");' +\n    '    var args = [].slice.call(arguments);' +\n    '    args.unshift(id);' +\n    '  return new Promise(function (resolve, reject) {' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n    '\" + id] = resolve;' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n    '\" + id] = reject;' +\n    '    window.webkit.messageHandlers.' +\n    CONSTANTS.JS_BRIDGE +\n    '.postMessage(JSON.stringify(args));' +\n    '  });' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    '(function () {' +\n    \"document.addEventListener('mousedown', onMouseDown);\" +\n    '' +\n    'function shouldDrag(target) {' +\n    '  if (!target || (target.dataset || {}).appRegion === \"no-drag\") { return false }' +\n    '  if ((target.dataset || {}).appRegion === \"drag\") { return true }' +\n    '  return shouldDrag(target.parentElement)' +\n    '};' +\n    '' +\n    'function onMouseDown(e) {' +\n    '  if (e.button !== 0 || !shouldDrag(e.target)) { return }' +\n    '  window.postMessage(\"' +\n    CONSTANTS.START_MOVING_WINDOW +\n    '\");' +\n    '};' +\n    '})()'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n\nmodule.exports.setupHandler = function(browserWindow) {\n  var initialMouseLocation = null\n  var initialWindowPosition = null\n  var interval = null\n\n  function moveWindow() {\n    // if the user released the button, stop moving the window\n    if (!initialWindowPosition || NSEvent.pressedMouseButtons() !== 1) {\n      clearInterval(interval)\n      initialMouseLocation = null\n      initialWindowPosition = null\n      return\n    }\n\n    var mouse = NSEvent.mouseLocation()\n    browserWindow.setPosition(\n      initialWindowPosition.x + (mouse.x - initialMouseLocation.x),\n      initialWindowPosition.y + (initialMouseLocation.y - mouse.y), // y is inverted\n      false\n    )\n  }\n\n  browserWindow.webContents.on(CONSTANTS.START_MOVING_WINDOW, function() {\n    initialMouseLocation = NSEvent.mouseLocation()\n    var position = browserWindow.getPosition()\n    initialWindowPosition = {\n      x: position[0],\n      y: position[1],\n    }\n\n    interval = setInterval(moveWindow, 1000 / 60) // 60 fps\n  })\n}\n","module.exports = function(webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments)\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('mocha-js-delegate')\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar NavigationDelegateClass\nvar WebScriptHandlerClass\nvar ThemeObserverClass\n\n// TODO: events\n// - 'page-favicon-updated'\n// - 'new-window'\n// - 'did-navigate-in-page'\n// - 'will-prevent-unload'\n// - 'crashed'\n// - 'unresponsive'\n// - 'responsive'\n// - 'destroyed'\n// - 'before-input-event'\n// - 'certificate-error'\n// - 'found-in-page'\n// - 'media-started-playing'\n// - 'media-paused'\n// - 'did-change-theme-color'\n// - 'update-target-url'\n// - 'cursor-changed'\n// - 'context-menu'\n// - 'select-bluetooth-device'\n// - 'paint'\n// - 'console-message'\n\nmodule.exports = function(browserWindow, panel, webview, options) {\n  if (!ThemeObserverClass) {\n    ThemeObserverClass = new ObjCClass({\n      utils: null,\n\n      'observeValueForKeyPath:ofObject:change:context:': function() {\n        this.utils.executeJavaScript(\n          \"document.body.classList.remove('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'light'\n              : 'dark') +\n            \"'); document.body.classList.add('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'dark'\n              : 'light') +\n            \"')\"\n        )\n      },\n    })\n  }\n\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = new ObjCClass({\n      utils: null,\n      panel: null,\n\n      'windowDidResize:': function() {\n        this.utils.emit('resize')\n      },\n\n      'windowDidMiniaturize:': function() {\n        this.utils.emit('minimize')\n      },\n\n      'windowDidDeminiaturize:': function() {\n        this.utils.emit('restore')\n      },\n\n      'windowDidEnterFullScreen:': function() {\n        this.utils.emit('enter-full-screen')\n      },\n\n      'windowDidExitFullScreen:': function() {\n        this.utils.emit('leave-full-screen')\n      },\n\n      'windowDidMove:': function() {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      'windowShouldClose:': function() {\n        var shouldClose = 1\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function() {\n            shouldClose = 0\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function() {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function() {\n        this.utils.emit('focus', this.panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function() {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!NavigationDelegateClass) {\n    NavigationDelegateClass = new ObjCClass({\n      state: {\n        wasReady: 0,\n      },\n      utils: null,\n\n      // // Called when the web view begins to receive web content.\n      'webView:didCommitNavigation:': function(webView) {\n        this.utils.emit('will-navigate', {}, String(String(webView.URL())))\n      },\n\n      // // Called when web content begins to load in a web view.\n      'webView:didStartProvisionalNavigation:': function() {\n        this.utils.emit('did-start-navigation')\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a web view receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalNavigation:': function() {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // // Called when the web view needs to respond to an authentication challenge.\n      // 'webView:didReceiveAuthenticationChallenge:completionHandler:': function(\n      //   webView,\n      //   challenge,\n      //   completionHandler\n      // ) {\n      //   function callback(username, password) {\n      //     completionHandler(\n      //       0,\n      //       NSURLCredential.credentialWithUser_password_persistence(\n      //         username,\n      //         password,\n      //         1\n      //       )\n      //     )\n      //   }\n      //   var protectionSpace = challenge.protectionSpace()\n      //   this.utils.emit(\n      //     'login',\n      //     {},\n      //     {\n      //       method: String(protectionSpace.authenticationMethod()),\n      //       url: 'not implemented', // TODO:\n      //       referrer: 'not implemented', // TODO:\n      //     },\n      //     {\n      //       isProxy: !!protectionSpace.isProxy(),\n      //       scheme: String(protectionSpace.protocol()),\n      //       host: String(protectionSpace.host()),\n      //       port: Number(protectionSpace.port()),\n      //       realm: String(protectionSpace.realm()),\n      //     },\n      //     callback\n      //   )\n      // },\n\n      // Called when an error occurs during navigation.\n      // 'webView:didFailNavigation:withError:': function(\n      //   webView,\n      //   navigation,\n      //   error\n      // ) {},\n\n      // Called when an error occurs while the web view is loading content.\n      'webView:didFailProvisionalNavigation:withError:': function(\n        webView,\n        navigation,\n        error\n      ) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when the navigation is complete.\n      'webView:didFinishNavigation:': function() {\n        if (this.state.wasReady == 0) {\n          this.state.wasReady = 1\n          this.utils.emitBrowserEvent('ready-to-show')\n        }\n        this.utils.emit('did-navigate')\n        this.utils.emit('did-frame-navigate')\n        this.utils.emit('did-stop-loading')\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n      },\n\n      // Called when the web views web content process is terminated.\n      'webViewWebContentProcessDidTerminate:': function() {\n        this.utils.emit('dom-ready')\n      },\n\n      // Decides whether to allow or cancel a navigation.\n      // webView:decidePolicyForNavigationAction:decisionHandler:\n\n      // Decides whether to allow or cancel a navigation after its response is known.\n      // webView:decidePolicyForNavigationResponse:decisionHandler:\n    })\n  }\n\n  if (!WebScriptHandlerClass) {\n    WebScriptHandlerClass = new ObjCClass({\n      utils: null,\n      'userContentController:didReceiveScriptMessage:': function(_, message) {\n        var args = this.utils.parseWebArguments(String(message.body()))\n        if (!args) {\n          return\n        }\n        if (!args[0] || typeof args[0] !== 'string') {\n          return\n        }\n        args[0] = String(args[0])\n\n        this.utils.emit.apply(this, args)\n      },\n    })\n  }\n\n  var themeObserver = ThemeObserverClass.new({\n    utils: {\n      executeJavaScript(script) {\n        webview.evaluateJavaScript_completionHandler(script, null)\n      },\n    },\n  })\n\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    \"document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-\" +\n      (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n        ? 'dark'\n        : 'light') +\n      \"') }, false)\",\n    0,\n    true\n  )\n  webview\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n\n  NSApplication.sharedApplication().addObserver_forKeyPath_options_context(\n    themeObserver,\n    'effectiveAppearance',\n    NSKeyValueChangeNewKey,\n    null\n  )\n\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n  threadDictionary[browserWindow.id + '.themeObserver'] = themeObserver\n\n  var navigationDelegate = NavigationDelegateClass.new({\n    utils: {\n      setTitle: browserWindow.setTitle.bind(browserWindow),\n      emitBrowserEvent() {\n        try {\n          browserWindow.emit.apply(browserWindow, arguments)\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n    },\n    state: {\n      wasReady: 0,\n    },\n  })\n\n  webview.setNavigationDelegate(navigationDelegate)\n\n  var webScriptHandler = WebScriptHandlerClass.new({\n    utils: {\n      emit(id, type) {\n        if (!type) {\n          webview.evaluateJavaScript_completionHandler(\n            CONSTANTS.JS_BRIDGE_RESULT_SUCCESS + id + '()',\n            null\n          )\n          return\n        }\n\n        var args = []\n        for (var i = 2; i < arguments.length; i += 1) args.push(arguments[i])\n\n        var listeners = browserWindow.webContents.listeners(type)\n\n        Promise.all(\n          listeners.map(function(l) {\n            return Promise.resolve().then(function() {\n              return l.apply(l, args)\n            })\n          })\n        )\n          .then(function(res) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n                id +\n                '(' +\n                JSON.stringify(res) +\n                ')',\n              null\n            )\n          })\n          .catch(function(err) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n                id +\n                '(' +\n                JSON.stringify(err) +\n                ')',\n              null\n            )\n          })\n      },\n      parseWebArguments: parseWebArguments,\n    },\n  })\n\n  webview\n    .configuration()\n    .userContentController()\n    .addScriptMessageHandler_name(webScriptHandler, CONSTANTS.JS_BRIDGE)\n\n  var utils = {\n    emit() {\n      try {\n        browserWindow.emit.apply(browserWindow, arguments)\n      } catch (err) {\n        if (\n          typeof process !== 'undefined' &&\n          process.listenerCount &&\n          process.listenerCount('uncaughtException')\n        ) {\n          process.emit('uncaughtException', err, 'uncaughtException')\n        } else {\n          console.error(err)\n          throw err\n        }\n      }\n    },\n  }\n  if (options.modal) {\n    // find the window of the document\n    var msdocument\n    if (options.parent.type === 'Document') {\n      msdocument = options.parent.sketchObject\n    } else {\n      msdocument = options.parent\n    }\n    if (msdocument && String(msdocument.class()) === 'MSDocumentData') {\n      // we only have an MSDocumentData instead of a MSDocument\n      // let's try to get back to the MSDocument\n      msdocument = msdocument.delegate()\n    }\n    utils.parentWindow = msdocument.windowForSheet()\n  }\n\n  var windowDelegate = WindowDelegateClass.new({\n    utils: utils,\n    panel: panel,\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('events')\nvar executeJavaScript = require('./execute-javascript')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n\n  webContents.loadFile = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.downloadURL = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.getURL = function() {\n    return String(webview.url())\n  }\n\n  webContents.getTitle = function() {\n    return String(webview.title())\n  }\n\n  webContents.isDestroyed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.focus = browserWindow.focus\n  webContents.isFocused = browserWindow.isFocused\n\n  webContents.isLoading = function() {\n    return !!webview.loading()\n  }\n\n  webContents.isLoadingMainFrame = function() {\n    // TODO:\n    return !!webview.loading()\n  }\n\n  webContents.isWaitingForResponse = function() {\n    return !webview.loading()\n  }\n\n  webContents.stop = function() {\n    webview.stopLoading()\n  }\n  webContents.reload = function() {\n    webview.reload()\n  }\n  webContents.reloadIgnoringCache = function() {\n    webview.reloadFromOrigin()\n  }\n  webContents.canGoBack = function() {\n    return !!webview.canGoBack()\n  }\n  webContents.canGoForward = function() {\n    return !!webview.canGoForward()\n  }\n  webContents.canGoToOffset = function(offset) {\n    return !!webview.backForwardList().itemAtIndex(offset)\n  }\n  webContents.clearHistory = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.goBack = function() {\n    webview.goBack()\n  }\n  webContents.goForward = function() {\n    webview.goForward()\n  }\n  webContents.goToIndex = function(index) {\n    var backForwardList = webview.backForwardList()\n    var backList = backForwardList.backList()\n    var backListLength = backList.count()\n    if (backListLength > index) {\n      webview.loadRequest(NSURLRequest.requestWithURL(backList[index]))\n      return\n    }\n    var forwardList = backForwardList.forwardList()\n    if (forwardList.count() > index - backListLength) {\n      webview.loadRequest(\n        NSURLRequest.requestWithURL(forwardList[index - backListLength])\n      )\n      return\n    }\n    throw new Error('Cannot go to index ' + index)\n  }\n  webContents.goToOffset = function(offset) {\n    if (!webContents.canGoToOffset(offset)) {\n      throw new Error('Cannot go to offset ' + offset)\n    }\n    webview.loadRequest(\n      NSURLRequest.requestWithURL(webview.backForwardList().itemAtIndex(offset))\n    )\n  }\n  webContents.isCrashed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setUserAgent = function(/* userAgent */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.getUserAgent = function() {\n    const userAgent = webview.customUserAgent()\n    return userAgent ? String(userAgent) : undefined\n  }\n  webContents.insertCSS = function(css) {\n    var source =\n      \"var style = document.createElement('style'); style.innerHTML = \" +\n      css.replace(/\"/, '\\\\\"') +\n      '; document.head.appendChild(style);'\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.insertJS = function(source) {\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.executeJavaScript = executeJavaScript(webview, browserWindow)\n  webContents.setIgnoreMenuShortcuts = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setAudioMuted = function(/* muted */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.isAudioMuted = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setZoomFactor = function(factor) {\n    webview.setMagnification_centeredAtPoint(factor, CGPointMake(0, 0))\n  }\n  webContents.getZoomFactor = function(callback) {\n    callback(Number(webview.magnification()))\n  }\n  webContents.setZoomLevel = function(level) {\n    // eslint-disable-next-line no-restricted-properties\n    webContents.setZoomFactor(Math.pow(1.2, level))\n  }\n  webContents.getZoomLevel = function(callback) {\n    // eslint-disable-next-line no-restricted-properties\n    callback(Math.log(Number(webview.magnification())) / Math.log(1.2))\n  }\n  webContents.setVisualZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setLayoutZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  // TODO:\n  // webContents.undo = function() {\n  //   webview.undoManager().undo()\n  // }\n  // webContents.redo = function() {\n  //   webview.undoManager().redo()\n  // }\n  // webContents.cut = webview.cut\n  // webContents.copy = webview.copy\n  // webContents.paste = webview.paste\n  // webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  // webContents.delete = webview.delete\n  // webContents.replace = webview.replaceSelectionWithText\n\n  webContents.send = function() {\n    const script =\n      'window.postMessage({' +\n      'isSketchMessage: true,' +\n      \"origin: '\" +\n      String(__command.identifier()) +\n      \"',\" +\n      'args: ' +\n      JSON.stringify([].slice.call(arguments)) +\n      '}, \"*\")'\n    webview.evaluateJavaScript_completionHandler(script, null)\n  }\n\n  webContents.getNativeWebview = function() {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function(identifier) {\n  return require('./lib').fromId(identifier) // eslint-disable-line\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  if (!module.exports.isWebviewPresent(identifier)) {\n    return\n  }\n\n  var panel = threadDictionary[identifier]\n  var webview = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webview &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webview = subviews[i]\n    }\n  }\n\n  if (!webview || !webview.evaluateJavaScript_completionHandler) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  webview.evaluateJavaScript_completionHandler(evalString, null)\n}\n","export const getRoot = (context) => {\n    return context.scriptPath.stringByDeletingLastPathComponent().stringByDeletingLastPathComponent().stringByDeletingLastPathComponent();\n};\nexport const getFileContent = (filePath) => {\n    //@ts-ignore\n    return NSString.stringWithContentsOfFile_encoding_error(filePath, 4, nil);\n};\nexport const getSavePath = (context) => {\n    let filePath = context.document.fileURL() ? context.document.fileURL().path().stringByDeletingLastPathComponent() : \"~\";\n    let fileName = context.document.displayName().stringByDeletingPathExtension();\n    //@ts-ignore\n    let savePanel = NSSavePanel.savePanel();\n    savePanel.setTitle(\"Export spec\");\n    savePanel.setNameFieldLabel(\"Export to:\");\n    savePanel.setPrompt(\"Export\");\n    savePanel.setCanCreateDirectories(true);\n    savePanel.setNameFieldStringValue(fileName);\n    //@ts-ignore\n    if (savePanel.runModal() != NSOKButton) {\n        return false;\n    }\n    return savePanel.URL().path();\n};\n//@ts-ignore\nexport const writeFile = (options) => {\n    //@ts-ignore\n    let content = NSString.stringWithString(options.content);\n    let savePathName = [];\n    //@ts-ignore\n    NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(options.path, true, nil, nil);\n    savePathName.push(options.path, \"/\", options.fileName);\n    savePathName = savePathName.join(\"\");\n    content.writeToFile_atomically_encoding_error(savePathName, false, 4, null);\n};\n","const removeIrrelevantLayers = (layers) => {\n    if (layers.length > 0) {\n        layers.forEach((layer) => {\n            if (layer.type === 'Group') {\n                removeIrrelevantLayers(layer.layers);\n            }\n            else if (layer.type === 'HotSpot' || layer.type === 'Slice' || layer.type === 'Artboard') {\n                layer.remove();\n            }\n        });\n    }\n};\nconst detatchSymbols = (layers) => {\n    if (layers.length > 0) {\n        layers.forEach((layer) => {\n            if (layer.type === 'Group') {\n                detatchSymbols(layer.layers);\n            }\n            else if (layer.type === 'SymbolInstance') {\n                layer.detach({\n                    recursively: true\n                });\n            }\n        });\n    }\n};\nconst removeHiddenLayers = (layers) => {\n    if (layers.length > 0) {\n        layers.forEach((layer) => {\n            const hidden = layer.hidden;\n            const transparent = layer.style.opacity === 0;\n            const hiddenOrTransparent = hidden || transparent;\n            if (layer.type === 'Group' && !hiddenOrTransparent) {\n                removeHiddenLayers(layer.layers);\n            }\n            else if (hiddenOrTransparent) {\n                layer.remove();\n            }\n        });\n    }\n};\nconst maskGroupToImageLayer = (maskGroup, sketch) => {\n    // create image buffer from layer\n    const buffer = sketch.export(maskGroup, {\n        formats: 'png',\n        output: false,\n        ['save-for-web']: true\n    });\n    // create image layer from buffer data\n    const imageLayer = new sketch.Image({\n        name: 'masked-group',\n        image: buffer\n    });\n    // set image layer frame to match mask group frame\n    imageLayer.frame = maskGroup.frame;\n    // return image layer\n    return imageLayer;\n};\nconst masksToImages = (layers, sketch) => {\n    if (layers.length > 0) {\n        layers.forEach((layer) => {\n            const hasClippingMask = layer.sketchObject.hasClippingMask();\n            const hasParentGroup = layer.parent && layer.parent.type === 'Group';\n            if (layer.type === 'Group' && !hasClippingMask) {\n                masksToImages(layer.layers, sketch);\n            }\n            else if (hasClippingMask && hasParentGroup) {\n                // @ts-ignore\n                const parent = layer.parent;\n                const parentIndex = parent.index;\n                const parentsParent = parent.parent;\n                const imageLayer = maskGroupToImageLayer(parent, sketch);\n                // splice in new image, splice out old mask group\n                parentsParent.layers.splice(parentIndex, 1, imageLayer);\n            }\n        });\n    }\n};\nconst flattenGroups = (layers) => {\n    if (layers.length > 0) {\n        layers.forEach((layer) => {\n            if (layer.type === \"Group\") {\n                layer.sketchObject.ungroup();\n                flattenGroups(layer.layers);\n            }\n        });\n    }\n};\nconst roundFrameDimensions = (layers) => {\n    layers.forEach((layer) => {\n        layer.frame.x = Math.round(layer.frame.x);\n        layer.frame.y = Math.round(layer.frame.y);\n        layer.frame.width = Math.round(layer.frame.width);\n        layer.frame.height = Math.round(layer.frame.height);\n    });\n};\nconst getArtboard = (selectedArtboard, sketch) => {\n    // duplicate artboard\n    let artboard = selectedArtboard.duplicate();\n    // reset duplicated artboard position\n    artboard.frame.x = 0;\n    artboard.frame.y = 0;\n    // removes hotspots, slices, and artboards\n    removeIrrelevantLayers(artboard.layers);\n    // detach all symbols from artboard, returns layer groups\n    detatchSymbols(artboard.layers);\n    // remove hidden layers\n    removeHiddenLayers(artboard.layers);\n    // turn masks into image layers\n    masksToImages(artboard.layers, sketch);\n    // flatten all groups\n    // flattenGroups(artboard.layers);\n    // round layer frame dimensions\n    roundFrameDimensions(artboard.layers);\n    // return final artboard\n    return artboard;\n};\nexport default getArtboard;\n","const createBase64Image = (nsdata, id) => {\n    let newImageBase64 = nsdata.base64EncodedStringWithOptions(0);\n    let newImage = 'data:image/png;base64,' + newImageBase64;\n    return {\n        id: id,\n        src: newImage\n    };\n};\nconst base64ImageBatch = (images) => {\n    return images.map((image) => {\n        return createBase64Image(image.nsdata, image.id);\n    });\n};\nconst layerToBase64 = (layer, id, sketch) => {\n    // create image buffer from layer\n    const buffer = sketch.export(layer, {\n        formats: 'png',\n        output: false,\n        ['save-for-web']: true\n    });\n    // create image from buffer data\n    const bufferImg = new sketch.Image({\n        image: buffer\n    });\n    // return base64 image\n    return createBase64Image(bufferImg.image.nsdata, id);\n};\nconst gradientToBase64 = (layer, id, sketch) => {\n    // get enabled gradients\n    const activeGradients = layer.style.fills.filter((fill) => {\n        return fill.enabled && fill.fillType === 'Gradient';\n    });\n    // get top gradient fill\n    const topGradient = activeGradients[activeGradients.length - 1];\n    // only keep layer gradient styles\n    layer.style.fills = [topGradient];\n    layer.style.borders = [];\n    layer.style.shadows = [];\n    layer.style.innerShadows = [];\n    layer.transform.rotation = 0;\n    layer.transform.flippedHorizontally = false;\n    layer.transform.flippedVertically = false;\n    if (layer.type === 'ShapePath') {\n        layer.points.forEach((point) => point.cornerRadius = 0);\n    }\n    // return base64 image\n    return layerToBase64(layer, id, sketch);\n};\nconst getBase64Gradients = (layers, sketch, images = []) => {\n    layers.forEach((layer) => {\n        if (layer.type === 'Shape' || layer.type === 'ShapePath') {\n            // check if fills contain any enabled gradients\n            const hasActiveGradient = layer.style.fills.some((fill) => {\n                return fill.fillType === 'Gradient' && fill.enabled;\n            });\n            // generate gradient base64\n            if (hasActiveGradient) {\n                // duplicate layer\n                // all styles but the gradient will be removed\n                const layerDuplicate = layer.duplicate();\n                // create base64 from duplicate layer\n                const base64Gradient = gradientToBase64(layerDuplicate, layer.id, sketch);\n                // push base64 gradient to images\n                images.push(base64Gradient);\n                // remove duplicate\n                layerDuplicate.remove();\n            }\n        }\n    });\n    return images;\n};\nconst getLayerImages = (layers, images = []) => {\n    layers.forEach((layer) => {\n        if (layer.type === 'Image') {\n            images.push(layer.image);\n        }\n    });\n    return images;\n};\nconst getFillImages = (layers, images = []) => {\n    layers.forEach((layer) => {\n        if (layer.type === 'Shape' || layer.type === 'ShapePath') {\n            layer.style.fills.forEach((fill) => {\n                if (fill.pattern.image !== null && fill.enabled) {\n                    images.push(fill.pattern.image);\n                }\n            });\n        }\n    });\n    return images;\n};\nconst getImages = (layers, sketch) => {\n    // get layers to turn into base64\n    const layerImages = getLayerImages(layers);\n    const fillImages = getFillImages(layers);\n    // generate base64 images from layers\n    const base64LayerImages = base64ImageBatch(layerImages);\n    const base64FillImages = base64ImageBatch(fillImages);\n    const base64Gradients = getBase64Gradients(layers, sketch);\n    // return final base64 image store\n    return [...base64LayerImages, ...base64FillImages, ...base64Gradients];\n};\nexport default getImages;\n","import getArtboard from './artboard';\nimport getImages from './images';\nimport getSVGs from './svgs';\nconst getStore = (selectedArtboard, sketch) => {\n    // get final store items\n    const artboard = getArtboard(selectedArtboard, sketch);\n    const images = getImages(artboard.layers, sketch);\n    const svgs = getSVGs(artboard.layers, sketch);\n    const notes = {};\n    // remove duplicate artboard\n    artboard.remove();\n    // run callback\n    return {\n        artboard,\n        images,\n        svgs,\n        notes\n    };\n};\nexport default getStore;\n","import { getFileContent } from '../export';\nconst getOddShapePathSVGs = (layers, sketch, svgs = []) => {\n    layers.forEach((layer) => {\n        if (layer.type === 'ShapePath') {\n            const hasOpenPath = !layer.closed;\n            const notRectangle = layer.shapeType !== 'Rectangle';\n            const notOval = layer.shapeType !== 'Oval';\n            const isOddShape = notRectangle && notOval;\n            if (hasOpenPath || isOddShape) {\n                // create svg in temp directory\n                sketch.export(layer, {\n                    formats: 'svg',\n                    // @ts-ignore\n                    output: NSTemporaryDirectory(),\n                    ['use-id-for-name']: true,\n                    compact: true,\n                    overwriting: true\n                });\n                // get new svg path\n                // @ts-ignore\n                const filePath = `${NSTemporaryDirectory()}${layer.id}.svg`;\n                // read contents of svg\n                const svgContent = getFileContent(filePath);\n                // set contents in svgs\n                svgs.push({\n                    id: layer.id,\n                    svg: `${svgContent}`\n                });\n            }\n        }\n    });\n    return svgs;\n};\nconst getShapeSVGs = (layers, sketch, svgs = []) => {\n    layers.forEach((layer) => {\n        if (layer.type === 'Shape') {\n            // create svg in temp directory\n            sketch.export(layer, {\n                formats: 'svg',\n                // @ts-ignore\n                output: NSTemporaryDirectory(),\n                ['use-id-for-name']: true,\n                compact: true,\n                overwriting: true\n            });\n            // get new svg path\n            // @ts-ignore\n            const filePath = `${NSTemporaryDirectory()}${layer.id}.svg`;\n            // read contents of svg\n            const svgContent = getFileContent(filePath);\n            // set contents in svgs\n            svgs.push({\n                id: layer.id,\n                svg: `${svgContent}`\n            });\n        }\n    });\n    return svgs;\n};\nconst getSVGs = (layers, sketch) => {\n    let shapeSvgs = getShapeSVGs(layers, sketch);\n    let oddShapePathSvgs = getOddShapePathSVGs(layers, sketch);\n    return [...shapeSvgs, ...oddShapePathSvgs];\n};\nexport default getSVGs;\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/c33bc743122bf05b16380174ee1a3040.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/e61d42c4d811c5f86c3ae93ff54d947b.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/ac44feac493c28292386027712bb0411.css\";","// @ts-ignore\nimport sketch from 'sketch/dom';\n// @ts-ignore\nimport ui from 'sketch/ui';\n// @ts-ignore\nimport BrowserWindow from 'sketch-module-web-view';\n// @ts-ignore\nimport { getWebview } from 'sketch-module-web-view/remote';\nimport getStore from '../resources/store';\nimport * as pluginExport from '../resources/export';\nconst webviewIdentifier = 'measure.webview';\nexport default (context) => {\n    // get document, selectedLayers, and artboard\n    const document = sketch.getSelectedDocument();\n    const selectedLayers = document.selectedLayers;\n    const artboard = selectedLayers.layers.find((layer) => {\n        return layer.type === 'Artboard' && layer.selected;\n    });\n    // if artboard selected, run command\n    if (artboard) {\n        //@ts-ignore\n        let store = getStore(artboard, sketch);\n        // set webview browser window\n        const browserWindow = new BrowserWindow({\n            identifier: webviewIdentifier,\n            width: 1200,\n            height: 900,\n            fullscreenable: false,\n            show: false\n        });\n        //browserWindow.setAspectRatio(1.33);\n        browserWindow.maximize();\n        browserWindow.center();\n        browserWindow.show();\n        // set webview contents\n        const webContents = browserWindow.webContents;\n        // load react app\n        browserWindow.loadURL(require('../resources/ui/index.html'));\n        // render app once webview contents loaded\n        webContents.on('did-finish-load', () => {\n            //@ts-ignore\n            webContents.executeJavaScript(`renderApp(${JSON.stringify(store)})`);\n        });\n        // open save prompt on save\n        webContents.on('save', (notes) => {\n            // add notes to store\n            store.notes = JSON.parse(notes);\n            // stringify store for export\n            let data = JSON.stringify(store);\n            // get save path\n            let savePath = pluginExport.getSavePath(context);\n            // get plugin root\n            let pluginRoot = pluginExport.getRoot(context);\n            // get js path\n            let scriptPath = `${pluginRoot}/Contents/Resources/resources_ui_spec.js`;\n            // get js map path\n            let scriptSourceMapPath = `${pluginRoot}/Contents/Resources/resources_ui_spec.js.map`;\n            // get css path\n            let stylesPath = require('../resources/ui/style.css').replace('file://', '');\n            // get html path\n            let templatePath = require('../resources/ui/spec.html').replace('file://', '');\n            // get css file name\n            // 32 + . + extension\n            let styleName = stylesPath.substr(-36);\n            // get contents of html\n            let template = pluginExport.getFileContent(templatePath);\n            // get contents of css\n            let styles = pluginExport.getFileContent(stylesPath);\n            // get contents of js\n            let script = pluginExport.getFileContent(scriptPath);\n            // add store to js string\n            let scriptWithStore = `var store = ${data}; ${script}`;\n            // get contents of js map\n            let scriptSourceMap = pluginExport.getFileContent(scriptSourceMapPath);\n            // create final html\n            pluginExport.writeFile({\n                content: template,\n                path: `${savePath}`,\n                fileName: 'spec.html'\n            });\n            // create final css\n            pluginExport.writeFile({\n                content: styles,\n                path: `${savePath}`,\n                fileName: styleName\n            });\n            // create final js\n            pluginExport.writeFile({\n                content: scriptWithStore,\n                path: `${savePath}`,\n                fileName: 'resources_ui_spec.js'\n            });\n            // create final js map\n            pluginExport.writeFile({\n                content: scriptSourceMap,\n                path: `${savePath}`,\n                fileName: 'resources_ui_spec.js.map'\n            });\n        });\n    }\n    else {\n        // if artboard not selected, alert user\n        ui.alert('Invalid Selection', 'Select an artboard to export.');\n    }\n};\nexport const onShutdown = () => {\n    const existingWebview = getWebview(webviewIdentifier);\n    if (existingWebview) {\n        existingWebview.close();\n    }\n};\n","module.exports = require(\"events\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}